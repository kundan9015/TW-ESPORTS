<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}TW ESPORTS{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Rajdhani:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    {% block head %}{% endblock %}
    <style>body{font-family: 'Rajdhani', sans-serif; background: transparent;}</style>
</head>
<body>

<button type="button" class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Menu"><span></span><span></span><span></span></button>
<div class="app-shell" id="appShell">
  <aside class="sidebar" id="sidebar">
    <div class="brand">
      <img src="{{ url_for('static', filename='twlogo.png') }}" height="34" alt="TW" onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 80 34%22><text x=%222%22 y=%2224%22 font-family=%22sans-serif%22 font-size=%2220%22 fill=%22%2366ff88%22>TW</text></svg>';">
      <div>
        <div class="neon-title" style="font-size:14px">TW ESPORTS</div>
        <div class="muted small">Team Control Panel</div>
      </div>
    </div>
    <div class="divider"></div>
    {% if current_user.is_authenticated %}
    <nav>
      <a class="nav-link-custom" href="/dashboard">ğŸ“Š Dashboard</a>
      <a class="nav-link-custom" href="/add_stats">ğŸ“¤ Upload Match</a>
      <a class="nav-link-custom" href="/leaderboard">ğŸ† Leaderboard</a>
      <a class="nav-link-custom" href="/graphs">ğŸ“ˆ Analytics</a>
      <a class="nav-link-custom" href="/attendance">âœ… Attendance</a>
      <a class="nav-link-custom" href="/edit_profile">ğŸ‘¤ Profile</a>
      {% if current_user.role == 'admin' %}
        <div class="divider"></div>
        <a class="nav-link-custom" href="/admin/bulk_stats">ğŸ“¤ Bulk Match Upload</a>
        <a class="nav-link-custom" href="/proofs">ğŸ–¼ï¸ Match Proofs</a>
        <a class="nav-link-custom" href="/activity_log">ğŸ“‹ Activity Log</a>
        <a class="nav-link-custom" href="/manage_players">âš™ï¸ Manage Players</a>
        <a class="nav-link-custom" href="/change_password">ğŸ” Change Password</a>
      {% endif %}
    </nav>
    <div class="divider"></div>
    <div style="margin-top:18px">
      <div class="muted">Signed in as</div>
      <div style="margin-top:6px; color: var(--text-secondary); font-weight: 600;">{{ current_user.username if current_user.is_authenticated else 'Guest' }}</div>
      {% if current_user.is_authenticated %}
        <div style="margin-top:8px"><a class="btn-ghost" href="/logout">Logout</a></div>
      {% endif %}
    </div>
    {% endif %}
  </aside>

  <main class="main-wrap">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="mb-3">
          <div class="glass-card" style="color: var(--text-primary); border-left: 4px solid var(--accent-primary);">{{ messages[0] }}</div>
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}

    <footer class="text-center text-muted small py-3">
      &copy; TW ESPORTS â€¢ Built for Free Fire teams
      <div class="footer-contact mt-1">
        Contact Team Mentor/Developer:
        <a class="footer-email" href="mailto:kundan1182004@gmail.com">kundan1182004@gmail.com</a>
      </div>
    </footer>
  </main>
</div>
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
(function(){
  var btn = document.getElementById('mobileMenuBtn');
  var sidebar = document.getElementById('sidebar');
  var overlay = document.getElementById('sidebarOverlay');
  if (btn && sidebar) {
    function open() { document.body.classList.add('mobile-nav-open'); }
    function close() { document.body.classList.remove('mobile-nav-open'); }
    function toggle() { document.body.classList.toggle('mobile-nav-open'); }
    btn.addEventListener('click', toggle);
    if (overlay) overlay.addEventListener('click', close);
    sidebar.querySelectorAll('a').forEach(function(a){ a.addEventListener('click', close); });
  }
})();
</script>
{% block scripts %}{% endblock %}
</body>
</html>
