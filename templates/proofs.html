{% extends "base.html" %}

{% block title %}Match Proofs{% endblock %}

{% block content %}
<h1 class="neon-title mb-4">üñºÔ∏è Match Proof Gallery</h1>

{% if proofs|length == 0 %}
  <div class="glass-card" style="text-align: center; padding: 40px;">
    <div style="font-size: 48px; margin-bottom: 12px;">üì∏</div>
    <div style="color: var(--text-secondary); font-weight: 600;">No proofs available yet</div>
    <div class="muted" style="margin-top: 8px;">Players will upload screenshots here</div>
  </div>
{% else %}
  <div class="gallery-grid">
    {% for p in proofs %}
      <div class="glass-card proof-card" style="padding: 0; overflow: hidden; transition: all .12s ease;">
        <div style="cursor: pointer;" onclick="openModal('{{ url_for('static', filename='uploads/' + p.screenshot) }}')">
          <img src="{{ url_for('static', filename='uploads/' + p.screenshot) }}" style="width: 100%; height: 160px; object-fit: cover; transition: transform .12s ease;">
          <div style="padding: 12px;">
            <div style="color: var(--accent-primary); font-weight: 600;">{{ p.player }}</div>
            <div class="muted small">{{ p.date }} ‚Ä¢ {{ p.kills }} kills</div>
          </div>
        </div>
        <div style="padding: 8px 12px; border-top: 1px solid rgba(255,255,255,0.06);">
          <form method="POST" action="{{ url_for('delete_proof', stat_id=p.id) }}" class="d-inline" onsubmit="return confirm('Delete this proof and match record?');">
            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>
{% endif %}

<!-- Modal -->
<div id="imageModal" class="modal-backdrop-custom" style="display: none;" onclick="closeModal()">
  <img id="modalImage" class="modal-img" onclick="event.stopPropagation();">
</div>

<style>
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
    gap: 14px;
    margin-bottom: 24px;
  }
  .modal-backdrop-custom {
    position: fixed;
    inset: 0;
    background: rgba(2, 6, 23, 0.85);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(4px);
  }
  .modal-img {
    max-width: 90vw;
    max-height: 90vh;
    border-radius: 10px;
    box-shadow: 0 20px 60px rgba(34,197,94,0.15);
  }
</style>

<script>
function openModal(src) {
  const modal = document.getElementById('imageModal');
  const img = document.getElementById('modalImage');
  img.src = src;
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  const modal = document.getElementById('imageModal');
  modal.style.display = 'none';
  document.body.style.overflow = 'auto';
}

// Close on ESC
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape') closeModal();
});
</script>
{% endblock %}
